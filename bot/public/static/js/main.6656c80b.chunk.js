(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{405:function(e,t,a){"use strict";(function(e){var n=a(52),r=a.n(n),s=a(80),o=a(100),c=a(16),i=a(17),l=a(19),m=a(18),u=a(54),h=a(20),d=a(0),p=a.n(d),f=a(33),v=a.n(f),b=a(73),E=a.n(b),y=a(46),g=a(41),D=a.n(g),O=a(40),w=a.n(O),S=a(44),j=a.n(S),C=a(30),I=a.n(C),T=a(103),k=a(406),x=a.n(k),N=a(409),R=a(407),_=function(t){function a(e){var t;return Object(c.a)(this,a),(t=Object(l.a)(this,Object(m.a)(a).call(this,e))).setParamState=function(e,a){t.setState(Object(o.a)({},e,a))},t.showInfo=function(e,a){return function(n){var r=Object(u.a)(t);t.state.allUser.map(function(n){n.mapCoordinate.x===e&&n.mapCoordinate.y===a&&t.state.floor===n.mapInfo.floorRefId&&r.setState({info:[n.manufacturer,n.userName,n.macAddress]})})}},t.state={floor:t.props.floor,info:[]},t.myInput=p.a.createRef(),t}return Object(h.a)(a,t),Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(){var t=Object(s.a)(r.a.mark(function t(a){var n,s,o,c;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(a.floor&&a.campus&&a.build)){t.next=15;break}return t.prev=1,n=E.a.location+"api/config/v1/maps/image"+a.imageSrc,s=JSON.parse(localStorage.getItem("cisco_auth")).location,t.next=6,v.a.get(n,{headers:{Authorization:s},responseType:"arraybuffer"});case 6:o=t.sent,c="data:image/png;base64,"+new e(o.data).toString("base64"),this.setState({img:c,floor:a.floor}),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(1),console.log(t.t0),v.a.post("/error",{data:t.t0.message}).catch(function(e){console.log(e)});case 15:case"end":return t.stop()}},t,this,[[1,11]])}));return function(e){return t.apply(this,arguments)}}()},{key:"render",value:function(){var e,t=this.props.classes;if(this.state.img){var a=this.myInput.current.offsetWidth,n=a/2;e=p.a.createElement(T.Stage,{width:a,height:n},p.a.createElement(N.a,{floor:this.state.floor,src:this.state.img,width:a,height:n,updateParam:this.setParamState,redDot:this.state.redDot,notification:this.props.notification,showInfo:this.showInfo}))}else e=p.a.createElement(w.a,null,p.a.createElement(j.a,{gutterBottom:!0,variant:"h5",component:"h2"},"Please select floor, building and cumpus"));return p.a.createElement(D.a,{className:t.card},p.a.createElement(I.a,{container:!0,direction:"column",justify:"space-between"},p.a.createElement("div",{ref:this.myInput,className:t.container},e,p.a.createElement(R.a,{users:this.state.allUser,redDot:this.setParamState,setFloor:this.props.setFloor,info:this.state.info}))))}}]),a}(p.a.Component);t.a=Object(y.withStyles)(function(e){return{card:{display:"flex",maxWidth:"1400px",height:"80vh",width:"90%"},media:{objectFit:"cover"},container:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",width:"100%"}}})(x()(_))}).call(this,a(906).Buffer)},407:function(e,t,a){"use strict";var n=a(56),r=a(16),s=a(17),o=a(19),c=a(18),i=a(54),l=a(20),m=a(0),u=a.n(m),h=a(46),d=a(70),p=a.n(d),f=a(98),v=a.n(f),b=a(192),E=a.n(b),y=a(408),g=a.n(y),D=a(40),O=a.n(D),w=a(44),S=a.n(w),j=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).handleInput=function(e){a.setState({userInput:e.target.value})},a.validate=function(e){return!(!e.match(/^([a-fA-F0-9]{2}:){5}([a-fA-F0-9]{2})$/g)&&!e.match(/^([a-z]{3,8})$/g))},a.handleClick=function(){var e=a.state.userInput,t=a.validate(e),r=Object(i.a)(a);if(""!==e)if(a.props.users)if(t){var s="";a.props.users.map(function(t){t.userName===e?(s=t.userName+" is at "+t.mapInfo.mapHierarchyString.split(">")[2],r.props.redDot("redDot",t),r.props.setFloor(t.mapInfo.floorRefId)):t.macAddress===e&&(s="Find "+t.macAddress+" at "+t.mapInfo.mapHierarchyString.split(">")[2],r.props.redDot("redDot",t),r.props.setFloor(t.mapInfo.floorRefId))}),""===s?a.setState(function(e){return{listOfsearch:[].concat(Object(n.a)(e.listOfsearch),[e.userInput+" not found"]),userInput:""}}):a.setState(function(e){return{listOfsearch:[].concat(Object(n.a)(e.listOfsearch),[s]),userInput:""}})}else a.setState(function(e){return{listOfsearch:[].concat(Object(n.a)(e.listOfsearch),["Wrong input"]),userInput:""}});else a.setState(function(e){return{listOfsearch:[].concat(Object(n.a)(e.listOfsearch),["Pls, choose floor"]),userInput:""}})},a.addInfo=function(e){var t=Object(i.a)(a);e.map(function(e){t.setState(function(t){return{listOfsearch:[].concat(Object(n.a)(t.listOfsearch),[e])}})})},a.handleKeyPress=function(e){"Enter"==e.key&&a.handleClick()},a.state={userInput:"",listOfsearch:[]},a}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.info!==this.props.info&&this.addInfo(e.info)}},{key:"render",value:function(){var e=this.props.classes;return u.a.createElement("div",{className:e.containerInput},u.a.createElement(O.a,{className:e.scroll},this.state.listOfsearch.map(function(e,t){return u.a.createElement(S.a,{key:t,component:"p"},e)})),u.a.createElement(p.a,{className:e.root,elevation:1},u.a.createElement(v.a,{className:e.input,placeholder:"Search macaddress or login",onChange:this.handleInput,value:this.state.userInput,onKeyPress:this.handleKeyPress}),u.a.createElement(E.a,{className:e.iconButton,"aria-label":"Search",onClick:this.handleClick},u.a.createElement(g.a,null))))}}]),t}(u.a.Component);t.a=Object(h.withStyles)({root:{padding:"2px 4px",display:"flex",alignItems:"center"},input:{marginLeft:8,flex:1},iconButton:{padding:10},divider:{width:1,height:28,margin:4},containerInput:{display:"flex",flexDirection:"column",justifyContent:"flex-end",height:"100%"},scroll:{overflowY:"scroll",height:"100%"}})(j)},409:function(e,t,a){"use strict";var n=a(52),r=a.n(n),s=a(80),o=a(56),c=a(16),i=a(17),l=a(19),m=a(18),u=a(54),h=a(20),d=a(0),p=a.n(d),f=a(33),v=a.n(f),b=a(73),E=a.n(b),y=a(103),g=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={image:null},a.handleLoad=function(){a.setState({image:a.image,width:a.image.width,height:a.image.height})},a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.loadImage()}},{key:"componentDidUpdate",value:function(e){e.src!==this.props.src&&this.loadImage()}},{key:"componentWillUnmount",value:function(){this.image.removeEventListener("load",this.handleLoad)}},{key:"loadImage",value:function(){this.image=new window.Image,this.image.src=this.props.src,this.image.addEventListener("load",this.handleLoad)}},{key:"render",value:function(){var e=this;return p.a.createElement(y.Image,{x:this.props.x,y:this.props.y,width:this.props.width,height:this.props.height,image:this.state.image,ref:function(t){e.imageNode=t}})}}]),t}(p.a.Component),D=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).updateCurent=function(){a.setState({current:[]},function(){var e=this;this.state.users.map(function(t){e.props.floor===t.mapInfo.floorRefId&&e.setState(function(e){return{current:[].concat(Object(o.a)(e.current),[t])}})})})},a.diplayNotification=function(e){var t=Array.from(e,function(e){return e.macAddress}),n=a.state.macAddr,r=t.filter(function(e){return!n.includes(e)});r.length<10&&0!=r.length&&a.props.notification("new "+r.join(" "))},a.request=function(){var e=E.a.location+"api/location/v2/clients",t=JSON.parse(localStorage.getItem("cisco_auth")).location,n=Object(u.a)(a);v.a.get(e,{headers:{Authorization:t}}).then(function(e){n.props.updateParam("allUser",e.data),a.diplayNotification(e.data),a.setState({users:e.data,macAddr:Array.from(e.data,function(e){return e.macAddress})},a.updateCurent)}).catch(function(e){console.log(e),v.a.post("/error",{data:e.message}).catch(function(e){console.log(e)})})},a.state={users:[],current:[],imgWidth:"",imgHeight:"",macAddr:[]},a.scaleWidth=a.scaleWidth.bind(Object(u.a)(a)),a.scaleHeight=a.scaleHeight.bind(Object(u.a)(a)),a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentWillReceiveProps",value:function(){var e=Object(s.a)(r.a.mark(function e(t){var a,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scaleWidth(t.src,t.width);case 2:return a=e.sent,e.next=5,this.scaleHeight(t.src,t.height);case 5:n=e.sent,this.setState({scaleWidth:a,scaleHeight:n}),this.setState({current:[]},function(){var e=this;this.state.users.map(function(a){t.floor===a.mapInfo.floorRefId&&e.setState(function(e){return{current:[].concat(Object(o.a)(e.current),[a])}})})});case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.request(),setInterval(this.request,1e4)}},{key:"componentWillMount",value:function(){var e=Object(s.a)(r.a.mark(function e(){var t,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scaleWidth(this.props.src,this.props.width);case 2:return t=e.sent,e.next=5,this.scaleHeight(this.props.src,this.props.height);case 5:a=e.sent,this.setState({scaleWidth:t,scaleHeight:a});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"scaleWidth",value:function(e,t){var a=new Image;return a.src=e,new Promise(function(e,n){a.onload=function(){e(t/a.width)}})}},{key:"scaleHeight",value:function(e,t){var a=new window.Image;return a.src=e,new Promise(function(e,n){a.onload=function(){e(t/a.height)}})}},{key:"render",value:function(){var e=this;return p.a.createElement(y.Layer,null,p.a.createElement(g,{src:this.props.src,x:0,y:0,width:this.props.width,height:this.props.height}),this.state.current.map(function(t,a){var n="green",r=1;return e.props.redDot&&e.props.redDot.mapCoordinate.x===t.mapCoordinate.x&&e.props.redDot.mapCoordinate.y===t.mapCoordinate.y&&(n="red",r=1.5),p.a.createElement(y.Rect,{titile:"lol",key:a,x:t.mapCoordinate.x*e.state.scaleWidth,y:t.mapCoordinate.y*e.state.scaleHeight,width:e.props.width/140*r,height:e.props.width/140*r,fill:n,onClick:e.props.showInfo(t.mapCoordinate.x,t.mapCoordinate.y)})}))}}]),t}(p.a.Component);t.a=D},492:function(e,t,a){e.exports=a(961)},496:function(e,t,a){},679:function(e,t,a){},73:function(e,t){e.exports={presence:"https://cisco-presence.unit.ua/",location:"https://cisco-cmx.unit.ua/"}},900:function(e,t,a){},960:function(e,t,a){},961:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(23),o=a.n(s),c=a(16),i=a(17),l=a(19),m=a(18),u=a(20),h=a(102),d=a(131),p=(a(496),a(30)),f=a.n(p),v=a(25),b=a.n(v),E=a(46),y=a(54),g=a(385),D=a.n(g),O=a(126),w=a.n(O),S=a(63),j=a.n(S),C=function(e){function t(e){var a;Object(c.a)(this,t),a=Object(l.a)(this,Object(m.a)(t).call(this,e));var n=new Date,r=b()(new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0,0)),s=b()(r).add(1,"days").subtract(1,"seconds");a.state={startDate:r,endDate:s};var o={start:b()(a.state.startDate).format("Y-MM-DD"),end:b()(a.state.endDate).format("Y-MM-DD")};return a.props.changeDate(o),a.applyCallback=a.applyCallback.bind(Object(y.a)(a)),a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"applyCallback",value:function(e,t){this.setState({startDate:e,endDate:t});var a={start:b()(e).format("Y-MM-DD"),end:b()(t).format("Y-MM-DD")};this.props.changeDate(a)}},{key:"render",value:function(){var e=this.props.classes,t=new Date,a=b()(new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0)),n=b()(a).add(1,"days").subtract(1,"seconds"),s={"Today Only":[b()(a),b()(n)],"Yesterday Only":[b()(a).subtract(1,"days"),b()(n).subtract(1,"days")],"3 Days":[b()(a).subtract(3,"days"),b()(n)]},o=b()(a).add(24,"hour");return r.a.createElement(D.a,{ranges:s,start:this.state.startDate,end:this.state.endDate,local:{format:"DD-MM-YYYY"},maxDate:o,applyCallback:this.applyCallback},r.a.createElement(j.a,{className:e.formControl},r.a.createElement(w.a,{value:b()(this.state.startDate).format("Y, MMMM D")+" - "+b()(this.state.endDate).format("Y, MMMM D")})))}}]),t}(n.Component),I=Object(E.withStyles)(function(e){return{formControl:{margin:e.spacing.unit,width:"100%"}}})(C),T=(a(679),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).handleChangeDate=function(e){a.setState({startDate:e.start,endDate:e.end});var t={startDate:e.start,endDate:e.end};a.props.handleParams(t)},a.state={startDate:b()(new Date).format("Y-MM-DD"),endDate:b()(new Date).format("Y-MM-DD")},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){this.props.classes;return r.a.createElement(f.a,{container:!0,direction:"row",className:"wrapper-24"},r.a.createElement(f.a,{item:!0,xs:9,md:4},r.a.createElement(I,{changeDate:this.handleChangeDate})))}}]),t}(n.Component)),k=Object(E.withStyles)(function(e){return{root:{display:"flex",flexWrap:"wrap"},formControl:{margin:e.spacing.unit,width:"100%"},selectEmpty:{marginTop:2*e.spacing.unit}}})(T),x=a(51),N=a(33),R=a.n(N),_=a(73),P=a.n(_),U=1513804707441;function M(){return{baseUrl:P.a.presence,data:{headers:{Authorization:JSON.parse(localStorage.getItem("cisco_auth")).presence},params:{siteId:U}}}}var Y=a(21),H=a(40),A=a.n(H),F=a(41),L=a.n(F),B=a(44),V=a.n(B),W=a(12),K=a(198),G=a.n(K),Q=["connected","passerby","visitors"],z={connected:{name:"Connected",color:"#2e7d32"},passerby:{name:"Passerby",color:"#0069fc"},visitors:{name:"Visitors",color:"#ff0043"}},q=Math.PI/180,X=function(e){var t=e.cx,a=e.cy,n=e.midAngle,s=e.innerRadius,o=e.outerRadius,c=e.percent,i=(e.index,s+.5*(o-s)),l=t+i*Math.cos(-n*q),m=a+i*Math.sin(-n*q);return r.a.createElement("text",{x:l,y:m,fill:"white",textAnchor:"start",dominantBaseline:"central"},"".concat((100*c).toFixed(0),"%"))},J=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).hideData=function(e){var t={};t[e]=!a.state[e],a.setState(t)},a.state={connected:!0,passerby:!0,visitors:!0},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"buildData",value:function(){var e=this,t=[];return Q.map(function(a,n){if(e.state[a]){var r={name:z[a].name,value:e.props[a],key:a};t.push(r)}}),t}},{key:"render",value:function(){var e=this,t=this.buildData(),a=Q.map(function(t,a){return r.a.createElement("div",{key:a,onClick:function(){return e.hideData(t)},className:"LegendItem",style:{backgroundColor:z[t].color,opacity:e.state[t]?1:.6}},z[t].name)});return r.a.createElement(L.a,null,r.a.createElement(A.a,null,r.a.createElement(W.a,{container:!0,direction:"row",className:"wrapper-sm-24 m-b-24"},r.a.createElement(G.a,null),r.a.createElement(V.a,{style:{margin:"5px 4px"},color:"textSecondary",gutterBottom:!0},"Total Count")),r.a.createElement(W.a,{container:!0,direction:"row",className:"wrapper-sm-24 m-b-24"},r.a.createElement(W.a,{item:!0,xs:12,className:"wrapper-24 FlexRow SpaceAround"},a)),r.a.createElement(Y.l,{width:"100%",height:500},r.a.createElement(Y.k,{onMouseEnter:this.onPieEnter},r.a.createElement(Y.j,{data:t,cx:"50%",cy:"50%",labelLine:!1,outerRadius:120,label:X,fill:"#8884d8"},t.map(function(e,t){return r.a.createElement(Y.g,{key:t,fill:z[e.key].color})})),r.a.createElement(Y.m,null)))))}}]),t}(n.Component),$=["connected","passerby","visitors"],Z={connected:{name:"connected",color:"#2e7d32"},passerby:{name:"passerby",color:"#0069fc"},visitors:{name:"visitors",color:"#ff0043"}},ee=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).setChartData=function(e,t){var n=0;for(var r in a.props[t])a.props[t].hasOwnProperty(r)&&("undefined"==typeof e[n]&&(e[n]={}),e[n].time=r,e[n][t]=a.props[t][r],n++);return e},a.hideData=function(e){var t={};t[e]=!a.state[e],a.setState(t)},a.RenderBrush=function(){return!!a.props.range&&r.a.createElement(Y.e,{dataKey:"time",height:30,stroke:"#8884d8"})},a.state={connected:!0,passerby:!0,visitors:!0},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=[];t=this.setChartData(t,"connected"),t=this.setChartData(t,"visitors"),t=this.setChartData(t,"passerby");var a=$.map(function(t,a){return r.a.createElement("div",{key:a,onClick:function(){return e.hideData(t)},className:"LegendItem",style:{backgroundColor:Z[t].color,opacity:e.state[t]?1:.6}},Z[t].name)}),n=$.map(function(t,a){return!!e.state[t]&&r.a.createElement(Y.c,{key:a,type:"monotone",dataKey:Z[t].name,fill:Z[t].color,fillOpacity:.8})});return r.a.createElement(L.a,null,r.a.createElement(A.a,null,r.a.createElement(W.a,{container:!0,direction:"row",className:"wrapper-sm-24 m-b-24"},r.a.createElement(G.a,null),r.a.createElement(V.a,{style:{margin:"5px 4px"},color:"textSecondary",gutterBottom:!0},"Proximity")),r.a.createElement("div",null,r.a.createElement(W.a,{container:!0,direction:"row",className:"wrapper-sm-24 m-b-24"},r.a.createElement(W.a,{item:!0,xs:12,className:"wrapper-24 FlexRow SpaceAround"},a)),r.a.createElement(Y.l,{width:"100%",height:500},r.a.createElement(Y.d,{data:t},r.a.createElement(Y.f,{stroke:"#ccc"}),r.a.createElement(Y.n,{dataKey:"time",height:60}),r.a.createElement(Y.o,null),r.a.createElement(Y.m,null),this.RenderBrush(),n)))))}}]),t}(n.Component),te=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).fetchAll=function(){a.fetchConnected(),a.fetchPasserby(),a.fetchVisitors(),a.fetchCountVisitors(),a.fetchCountConnected(),a.fetchCountPasserby()},a.buildQueryDateParams=function(){return a.state.startDate===a.state.endDate?{date:a.state.startDate}:{startDate:a.state.startDate,endDate:a.state.endDate}},a.isRange=function(){return a.state.startDate!==a.state.endDate},a.state={startDate:a.props.startDate,endDate:a.props.endDate,visitorsCount:0,connectedCount:0,passerbyCount:0,visitors:[],connected:[],passerby:[]},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this;this.setState({startDate:e.startDate,endDate:e.endDate},function(){a.fetchAll()})}},{key:"fetchConnected",value:function(){var e=this,t=M(),a=this.state.startDate===this.state.endDate?"hourly":"daily";t.data.params=Object(x.a)({},t.data.params,this.buildQueryDateParams()),R.a.get(t.baseUrl+"api/presence/v1/connected/"+a,t.data).then(function(t){e.setState({connected:t.data})}).catch(function(e){console.log(e)})}},{key:"fetchPasserby",value:function(){var e=this,t=M(),a=this.state.startDate===this.state.endDate?"hourly":"daily";t.data.params=Object(x.a)({},t.data.params,this.buildQueryDateParams()),R.a.get(t.baseUrl+"api/presence/v1/passerby/"+a,t.data).then(function(t){e.setState({passerby:t.data})}).catch(function(e){console.log(e)})}},{key:"fetchVisitors",value:function(){var e=this,t=M(),a=this.state.startDate===this.state.endDate?"hourly":"daily";t.data.params=Object(x.a)({},t.data.params,this.buildQueryDateParams()),R.a.get(t.baseUrl+"api/presence/v1/visitor/"+a,t.data).then(function(t){e.setState({visitors:t.data})}).catch(function(e){console.log(e)})}},{key:"fetchCountVisitors",value:function(){var e=this,t=M();t.data.params.startDate=this.state.startDate,t.data.params.endDate=this.state.endDate,R.a.get(t.baseUrl+"api/presence/v1/visitor/total",t.data).then(function(t){e.setState({visitorsCount:t.data})}).catch(function(e){console.log(e)})}},{key:"fetchCountConnected",value:function(){var e=this,t=M();t.data.params.startDate=this.state.startDate,t.data.params.endDate=this.state.endDate,R.a.get(t.baseUrl+"api/presence/v1/connected/total",t.data).then(function(t){e.setState({connectedCount:t.data})}).catch(function(e){console.log(e)})}},{key:"fetchCountPasserby",value:function(){var e=this,t=M();t.data.params.startDate=this.state.startDate,t.data.params.endDate=this.state.endDate,R.a.get(t.baseUrl+"api/presence/v1/passerby/total",t.data).then(function(t){e.setState({passerbyCount:t.data})}).catch(function(e){console.log(e)})}},{key:"render",value:function(){return r.a.createElement(f.a,{container:!0,direction:"row",spacing:24,className:"sm-no-spacing"},r.a.createElement(f.a,{item:!0,xs:12,md:8,className:"m-t-sm-24"},r.a.createElement(ee,{visitors:this.state.visitors,connected:this.state.connected,passerby:this.state.passerby,range:this.isRange()})),r.a.createElement(f.a,{item:!0,xs:12,md:4,className:"m-t-sm-24"},r.a.createElement(J,{visitors:this.state.visitorsCount,connected:this.state.connectedCount,passerby:this.state.passerbyCount})))}}]),t}(n.Component),ae=a(129),ne=a.n(ae),re={FIVE_TO_THIRTY_MINUTES:{name:"5-30 min",color:"#4caf50"},THIRTY_TO_SIXTY_MINUTES:{name:"30-60 min",color:"#f57f17"},ONE_TO_FIVE_HOURS:{name:"1-5 hrs",color:"#2196f3"},FIVE_TO_EIGHT_HOURS:{name:"5-8 hrs",color:"#1a237e"},EIGHT_PLUS_HOURS:{name:"8+ hrs",color:"#b71c1c"}},se=["FIVE_TO_THIRTY_MINUTES","THIRTY_TO_SIXTY_MINUTES","ONE_TO_FIVE_HOURS","FIVE_TO_EIGHT_HOURS","EIGHT_PLUS_HOURS"],oe=Math.PI/180,ce=function(e){var t=e.cx,a=e.cy,n=e.midAngle,s=e.innerRadius,o=e.outerRadius,c=e.percent,i=(e.index,s+.5*(o-s)),l=t+i*Math.cos(-n*oe),m=a+i*Math.sin(-n*oe),u=(100*c).toFixed(0);return r.a.createElement("text",{x:l,y:m,fill:"white",textAnchor:"start",dominantBaseline:"central"},u>5?"".concat(u,"%"):"")},ie=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).hideData=function(e){var t={};t[e]=!a.state[e],a.setState(t)},a.state={FIVE_TO_THIRTY_MINUTES:!0,THIRTY_TO_SIXTY_MINUTES:!0,ONE_TO_FIVE_HOURS:!0,FIVE_TO_EIGHT_HOURS:!0,EIGHT_PLUS_HOURS:!0},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"buildData",value:function(){var e=this,t=[];return se.map(function(a,n){if(e.state[a]){var r={name:re[a].name,value:e.props.countDwellTime[a],key:a};t.push(r)}}),t}},{key:"render",value:function(){var e=this,t=this.buildData(),a=se.map(function(t,a){return r.a.createElement("div",{key:a,onClick:function(){return e.hideData(t)},className:"LegendItem",style:{backgroundColor:re[t].color,opacity:e.state[t]?1:.6}},re[t].name)});return r.a.createElement(L.a,null,r.a.createElement(A.a,null,r.a.createElement(W.a,{container:!0,direction:"row",className:"wrapper-sm-24 m-b-24"},r.a.createElement(ne.a,null),r.a.createElement(V.a,{style:{margin:"5px 4px"},color:"textSecondary",gutterBottom:!0},"Total Count")),r.a.createElement(W.a,{container:!0,direction:"row",className:"wrapper-sm-24 m-b-24"},r.a.createElement(W.a,{item:!0,xs:12,className:"wrapper-24 FlexRow SpaceAround"},a)),r.a.createElement(Y.l,{width:"100%",height:500},r.a.createElement(Y.k,{onMouseEnter:this.onPieEnter},r.a.createElement(Y.j,{data:t,cx:"50%",cy:"50%",labelLine:!1,outerRadius:120,label:ce,fill:"#8884d8"},t.map(function(e,t){return r.a.createElement(Y.g,{key:t,fill:re[e.key].color})})),r.a.createElement(Y.m,null)))))}}]),t}(n.Component),le={FIVE_TO_THIRTY_MINUTES:{name:"5-30 min",color:"#4caf50"},THIRTY_TO_SIXTY_MINUTES:{name:"30-60 min",color:"#f57f17"},ONE_TO_FIVE_HOURS:{name:"1-5 hrs",color:"#2196f3"},FIVE_TO_EIGHT_HOURS:{name:"5-8 hrs",color:"#1a237e"},EIGHT_PLUS_HOURS:{name:"8+ hrs",color:"#b71c1c"}},me=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).setChartData=function(e){var t=0;for(var n in a.props.dwellTime)if(a.props.dwellTime.hasOwnProperty(n)){var r={};for(var s in a.props.dwellTime[n])a.props.dwellTime[n].hasOwnProperty(s)&&(r[le[s].name]=a.props.dwellTime[n][s]);e[t]=r,e[t].time=n,t++}return e},a.hideData=function(e){var t={};t[e]=!a.state[e],a.setState(t)},a.RenderBrush=function(){return!!a.props.range&&r.a.createElement(Y.e,{dataKey:"time",height:30,stroke:"#8884d8"})},a.state={FIVE_TO_THIRTY_MINUTES:!0,THIRTY_TO_SIXTY_MINUTES:!0,ONE_TO_FIVE_HOURS:!0,FIVE_TO_EIGHT_HOURS:!0,EIGHT_PLUS_HOURS:!0},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=[];t=this.setChartData(t);var a=["FIVE_TO_THIRTY_MINUTES","THIRTY_TO_SIXTY_MINUTES","ONE_TO_FIVE_HOURS","FIVE_TO_EIGHT_HOURS","EIGHT_PLUS_HOURS"],n=a.map(function(t,a){return r.a.createElement("div",{key:a,onClick:function(){return e.hideData(t)},className:"LegendItem",style:{backgroundColor:le[t].color,opacity:e.state[t]?1:.6}},le[t].name)}),s=a.map(function(t,a){return!!e.state[t]&&r.a.createElement(Y.a,{key:a,type:"monotone",dataKey:le[t].name,stroke:le[t].color,fillOpacity:1,fill:"url(#"+t+")"})}),o=a.map(function(e,t){return r.a.createElement("linearGradient",{key:t,id:e,x1:"0",y1:"0",x2:"0",y2:"1"},r.a.createElement("stop",{offset:"5%",stopColor:le[e].color,stopOpacity:.9}),r.a.createElement("stop",{offset:"95%",stopColor:le[e].color,stopOpacity:0}))});return r.a.createElement(L.a,null,r.a.createElement(A.a,null,r.a.createElement(W.a,{container:!0,direction:"row",className:"wrapper-sm-24 m-b-24"},r.a.createElement(ne.a,null),r.a.createElement(V.a,{style:{margin:"5px 4px"},color:"textSecondary",gutterBottom:!0},"Dwell Time")),r.a.createElement("div",null,r.a.createElement(W.a,{container:!0,direction:"row",className:"wrapper-sm-24 m-b-24"},r.a.createElement(W.a,{item:!0,xs:12,className:"wrapper-24 FlexRow SpaceAround"},n)),r.a.createElement(Y.l,{width:"100%",height:500},r.a.createElement(Y.b,{data:t,margin:{top:10,right:30,left:0,bottom:0}},r.a.createElement("defs",null,o),r.a.createElement(Y.n,{dataKey:"time"}),r.a.createElement(Y.o,null),r.a.createElement(Y.f,{strokeDasharray:"3 3"}),r.a.createElement(Y.m,null),this.RenderBrush(),s)))))}}]),t}(n.Component),ue=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).buildQueryDateParams=function(){return a.state.startDate===a.state.endDate?{date:a.state.startDate}:{startDate:a.state.startDate,endDate:a.state.endDate}},a.fetchAll=function(){a.fetchDwellTime(),a.fetchCountDwellTime()},a.isRange=function(){return a.state.startDate!==a.state.endDate},a.state={startDate:a.props.startDate,endDate:a.props.endDate,dwellTime:[],countDwellTime:{}},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this;this.setState({startDate:e.startDate,endDate:e.endDate,dwellTime:[]},function(){a.fetchAll()})}},{key:"fetchDwellTime",value:function(){var e=this,t=M(),a=this.state.startDate===this.state.endDate?"hourly":"daily";t.data.params=Object(x.a)({},t.data.params,this.buildQueryDateParams()),R.a.get(t.baseUrl+"api/presence/v1/dwell/"+a,t.data).then(function(t){e.setState({dwellTime:t.data})}).catch(function(e){console.log(e)})}},{key:"fetchCountDwellTime",value:function(){var e=this,t=M();t.data.params=Object(x.a)({},t.data.params,this.buildQueryDateParams()),R.a.get(t.baseUrl+"api/presence/v1/dwell/count",t.data).then(function(t){console.log("RESPONSE: ",t.data),e.setState({countDwellTime:t.data})}).catch(function(e){console.log(e)})}},{key:"render",value:function(){return r.a.createElement(f.a,{container:!0,direction:"row",spacing:24,className:"sm-no-spacing"},r.a.createElement(f.a,{item:!0,xs:12,md:8,className:"m-t-sm-24"},r.a.createElement(me,{range:this.isRange(),dwellTime:this.state.dwellTime})),r.a.createElement(f.a,{item:!0,xs:12,md:4,className:"m-t-sm-24"},r.a.createElement(ie,{countDwellTime:this.state.countDwellTime})))}}]),t}(n.Component),he=a(199),de=a.n(he),pe=["DAILY","WEEKLY","OCCASIONAL","FIRST_TIME","YESTERDAY"],fe={DAILY:{name:"Daily",color:"#4caf50"},WEEKLY:{name:"Weekly",color:"#f57f17"},OCCASIONAL:{name:"Occasional",color:"#2196f3"},FIRST_TIME:{name:"First Time",color:"#1a237e"},YESTERDAY:{name:"Yesterday",color:"#b71c1c"}},ve=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).setChartData=function(e){var t=0;for(var n in a.props.repeatVisitors)if(a.props.repeatVisitors.hasOwnProperty(n)){var r={};for(var s in a.props.repeatVisitors[n])a.props.repeatVisitors[n].hasOwnProperty(s)&&(r[fe[s].name]=a.props.repeatVisitors[n][s]);e[t]=r,e[t].time=n,t++}return e},a.hideData=function(e){var t={};t[e]=!a.state[e],a.setState(t)},a.RenderBrush=function(){return!!a.props.range&&r.a.createElement(Y.e,{dataKey:"time",height:30,stroke:"#8884d8"})},a.state={DAILY:!0,WEEKLY:!0,OCCASIONAL:!0,FIRST_TIME:!0,YESTERDAY:!0},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=[];t=this.setChartData(t);var a=pe.map(function(t,a){return r.a.createElement("div",{key:a,onClick:function(){return e.hideData(t)},className:"LegendItem",style:{backgroundColor:fe[t].color,opacity:e.state[t]?1:.6}},fe[t].name)}),n=pe.map(function(t,a){return!!e.state[t]&&r.a.createElement(Y.h,{key:a,type:"monotone",dataKey:fe[t].name,stroke:fe[t].color})});return r.a.createElement(L.a,null,r.a.createElement(A.a,null,r.a.createElement(W.a,{container:!0,direction:"row",className:"wrapper-sm-24 m-b-24"},r.a.createElement(de.a,null),r.a.createElement(V.a,{style:{margin:"5px 4px"},color:"textSecondary",gutterBottom:!0},"Repeat Visitors")),r.a.createElement("div",null,r.a.createElement(W.a,{container:!0,direction:"row",className:"wrapper-sm-24 m-b-24"},r.a.createElement(W.a,{item:!0,xs:12,className:"wrapper-24 FlexRow SpaceAround"},a)),r.a.createElement(Y.l,{width:"100%",height:500},r.a.createElement(Y.i,{data:t,margin:{top:10,right:30,left:0,bottom:0}},r.a.createElement(Y.n,{dataKey:"time"}),r.a.createElement(Y.o,null),r.a.createElement(Y.f,{strokeDasharray:"3 3"}),r.a.createElement(Y.m,null),this.RenderBrush(),n)))))}}]),t}(n.Component),be=["DAILY","WEEKLY","OCCASIONAL","FIRST_TIME","YESTERDAY"],Ee={DAILY:{name:"Daily",color:"#4caf50"},WEEKLY:{name:"Weekly",color:"#f57f17"},OCCASIONAL:{name:"Occasional",color:"#2196f3"},FIRST_TIME:{name:"First Time",color:"#1a237e"},YESTERDAY:{name:"Yesterday",color:"#b71c1c"}},ye=Math.PI/180,ge=function(e){var t=e.cx,a=e.cy,n=e.midAngle,s=e.innerRadius,o=e.outerRadius,c=e.percent,i=(e.index,s+.5*(o-s)),l=t+i*Math.cos(-n*ye),m=a+i*Math.sin(-n*ye),u=(100*c).toFixed(0);return r.a.createElement("text",{x:l,y:m,fill:"white",textAnchor:"start",dominantBaseline:"central"},u>5?"".concat(u,"%"):"")},De=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).hideData=function(e){var t={};t[e]=!a.state[e],a.setState(t)},a.state={DAILY:!0,WEEKLY:!0,OCCASIONAL:!0,FIRST_TIME:!0,YESTERDAY:!0},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"buildData",value:function(){var e=this,t=[];return be.map(function(a,n){if(e.state[a]){var r={name:Ee[a].name,value:e.props.count[a],key:a};t.push(r)}}),t}},{key:"render",value:function(){var e=this,t=this.buildData(),a=be.map(function(t,a){return r.a.createElement("div",{key:a,onClick:function(){return e.hideData(t)},className:"LegendItem",style:{backgroundColor:Ee[t].color,opacity:e.state[t]?1:.6}},Ee[t].name)});return r.a.createElement(L.a,null,r.a.createElement(A.a,null,r.a.createElement(W.a,{container:!0,direction:"row",className:"wrapper-sm-24 m-b-24"},r.a.createElement(de.a,null),r.a.createElement(V.a,{style:{margin:"5px 4px"},color:"textSecondary",gutterBottom:!0},"Total Count")),r.a.createElement(W.a,{container:!0,direction:"row",className:"wrapper-sm-24 m-b-24"},r.a.createElement(W.a,{item:!0,xs:12,className:"wrapper-24 FlexRow SpaceAround"},a)),r.a.createElement(Y.l,{width:"100%",height:500},r.a.createElement(Y.k,{onMouseEnter:this.onPieEnter},r.a.createElement(Y.j,{data:t,cx:"50%",cy:"50%",labelLine:!1,outerRadius:120,label:ge,fill:"#8884d8"},t.map(function(e,t){return r.a.createElement(Y.g,{key:t,fill:Ee[e.key].color})})),r.a.createElement(Y.m,null)))))}}]),t}(n.Component),Oe=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).buildQueryDateParams=function(){return a.state.startDate===a.state.endDate?{date:a.state.startDate}:{startDate:a.state.startDate,endDate:a.state.endDate}},a.fetchAll=function(){a.fetchRepeatVisitors(),a.fetchCount()},a.isRange=function(){return a.state.startDate!==a.state.endDate},a.state={startDate:a.props.startDate,endDate:a.props.endDate,repeatVisitors:[],count:{}},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this;this.setState({startDate:e.startDate,endDate:e.endDate,repeatVisitors:[]},function(){a.fetchAll()})}},{key:"fetchRepeatVisitors",value:function(){var e=this,t=M(),a=this.state.startDate===this.state.endDate?"hourly":"daily";t.data.params=Object(x.a)({},t.data.params,this.buildQueryDateParams()),R.a.get(t.baseUrl+"api/presence/v1/repeatvisitors/"+a,t.data).then(function(t){e.setState({repeatVisitors:t.data})}).catch(function(e){console.log(e)})}},{key:"fetchCount",value:function(){var e=this,t=M();t.data.params=Object(x.a)({},t.data.params,this.buildQueryDateParams()),R.a.get(t.baseUrl+"api/presence/v1/repeatvisitors/count",t.data).then(function(t){e.setState({count:t.data})}).catch(function(e){console.log(e)})}},{key:"render",value:function(){return r.a.createElement(f.a,{container:!0,direction:"row",spacing:24,className:"sm-no-spacing"},r.a.createElement(f.a,{item:!0,xs:12,md:8,className:"m-t-sm-24"},r.a.createElement(ve,{range:this.isRange(),repeatVisitors:this.state.repeatVisitors})),r.a.createElement(f.a,{item:!0,xs:12,md:4,className:"m-t-sm-24"},r.a.createElement(De,{count:this.state.count})))}}]),t}(n.Component),we=a(401),Se=a.n(we),je=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).state={},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(f.a,{item:!0,xs:12,sm:6,md:3,className:"m-t-sm-24"},r.a.createElement(L.a,{style:{height:"100%"}},r.a.createElement(A.a,null,r.a.createElement("div",{className:"textRow"},r.a.createElement(W.b,{gutterBottom:!0,variant:"headline"},"Visitors"),r.a.createElement(Se.a,{style:{fontSize:32}})),r.a.createElement("hr",null),r.a.createElement("div",{className:"textRow"},r.a.createElement(W.b,{className:"rowTitle",gutterBottom:!0,variant:"caption"},"Total Visitors:"),r.a.createElement(W.b,{gutterBottom:!0,variant:"body1"},this.props.visitors)),r.a.createElement("div",{className:"textRow"},r.a.createElement(W.b,{className:"rowTitle",gutterBottom:!0,variant:"caption"},"Total Connected:"),r.a.createElement(W.b,null,this.props.connected)),r.a.createElement("div",{className:"textRow"},r.a.createElement(W.b,{className:"rowTitle",gutterBottom:!0,variant:"caption"},"Total Passerby:"),r.a.createElement(W.b,null,this.props.passerby)),r.a.createElement("div",{className:"textRow"},r.a.createElement(W.b,{className:"rowTitle",gutterBottom:!0,variant:"caption"},"Connected Percentage:"),r.a.createElement(W.b,null,this.props.precentage," %")),r.a.createElement("div",{className:"textRow"},r.a.createElement(W.b,{className:"rowTitle",gutterBottom:!0,variant:"caption"},"Conversion Rate:"),r.a.createElement(W.b,null,this.props.conversionRate," %")))))}}]),t}(n.Component),Ce=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).state={},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"peakHourFormat",value:function(){try{var e=this.props.peakSummary.peakHour,t=this.props.peakSummary.peakHour+1;return(e<10?"0"+e+":00":e+":00")+" - "+(t<10?"0"+t+":00":t+":00")}catch(a){}}},{key:"averageDwelTime",value:function(){return parseInt(parseInt(this.props.averageDwellTime)/60)+" hrs "+parseInt(this.props.averageDwellTime)%60+" min"}},{key:"render",value:function(){return r.a.createElement(f.a,{item:!0,xs:12,sm:6,md:3,className:"m-t-sm-24"},r.a.createElement(L.a,{style:{height:"100%"}},r.a.createElement(A.a,null,r.a.createElement("div",{className:"textRow"},r.a.createElement(W.b,{gutterBottom:!0,variant:"headline"},"Dwell Time"),r.a.createElement(ne.a,{style:{fontSize:32}})),r.a.createElement("hr",null),r.a.createElement("div",{className:"textRow"},r.a.createElement(W.b,{className:"rowTitle",gutterBottom:!0,variant:"caption"},"Average Dwell Time:"),r.a.createElement(W.b,{gutterBottom:!0,variant:"body1"},this.averageDwelTime())),r.a.createElement("div",{className:"textRow"},r.a.createElement(W.b,{className:"rowTitle",gutterBottom:!0,variant:"caption"},"Peak Hour:"),r.a.createElement(W.b,null," ",this.peakHourFormat()," ")),r.a.createElement("div",{className:"textRow"},r.a.createElement(W.b,{className:"rowTitle",gutterBottom:!0,variant:"caption"},"Users in peak hour:"),r.a.createElement(W.b,null,this.props.peakSummary.peakHourCount)),r.a.createElement("div",{className:"textRow"},r.a.createElement(W.b,{className:"rowTitle",gutterBottom:!0,variant:"caption"},"5-30 min:"),r.a.createElement(W.b,null,this.props.dwellLevels.FIVE_TO_THIRTY_MINUTES.count)),r.a.createElement("div",{className:"textRow"},r.a.createElement(W.b,{className:"rowTitle",gutterBottom:!0,variant:"caption"},"30-60 min:"),r.a.createElement(W.b,null,this.props.dwellLevels.THIRTY_TO_SIXTY_MINUTES.count)),r.a.createElement("div",{className:"textRow"},r.a.createElement(W.b,{className:"rowTitle",gutterBottom:!0,variant:"caption"},"1-5 hrs:"),r.a.createElement(W.b,null,this.props.dwellLevels.ONE_TO_FIVE_HOURS.count)),r.a.createElement("div",{className:"textRow"},r.a.createElement(W.b,{className:"rowTitle",gutterBottom:!0,variant:"caption"},"5-8 hrs:"),r.a.createElement(W.b,null,this.props.dwellLevels.FIVE_TO_EIGHT_HOURS.count)),r.a.createElement("div",{className:"textRow"},r.a.createElement(W.b,{className:"rowTitle",gutterBottom:!0,variant:"caption"},"8+ hrs:"),r.a.createElement(W.b,null,this.props.dwellLevels.EIGHT_PLUS_HOURS.count)))))}}]),t}(n.Component),Ie=a(402),Te=a.n(Ie),ke=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).state={},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props.devices,a=Object.keys(t).sort(function(e,a){return t[a]-t[e]});console.log("sortedDevices: ",a);var n=[];for(var s in a)a.hasOwnProperty(s)&&n.push(a[s]);var o=n.map(function(t,a){return r.a.createElement("div",{key:a,className:"textRow"},r.a.createElement(W.b,{className:"rowTitle",gutterBottom:!0,variant:"caption"},t,":"),r.a.createElement(W.b,{gutterBottom:!0,variant:"body1"},e.props.devices[t]))});return r.a.createElement(f.a,{item:!0,xs:12,sm:6,md:3,className:"m-t-sm-24"},r.a.createElement(L.a,{style:{height:"100%"}},r.a.createElement(A.a,null,r.a.createElement("div",{className:"textRow"},r.a.createElement(W.b,{gutterBottom:!0,variant:"headline"},"Devices"),r.a.createElement(Te.a,{style:{fontSize:32}})),r.a.createElement("hr",null),o)))}}]),t}(n.Component),xe=a(403),Ne=a.n(xe),Re=["visitors","connected","passerby"],_e=function(e){function t(e){var a;Object(c.a)(this,t),a=Object(l.a)(this,Object(m.a)(t).call(this,e));var n=b()(new Date).format("Y-MM-DD"),r=b()(new Date).add(-30,"days").format("Y-MM-DD");return a.state={startDate:r,endDate:n,visitors:void 0,connected:void 0,passerby:void 0},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentWillMount",value:function(){this.fetchConnected(),this.fetchPasserby(),this.fetchVisitors()}},{key:"fetchConnected",value:function(){var e=this,t=M(),a={};a.startDate=this.state.startDate,a.endDate=this.state.endDate,t.data.params=Object(x.a)({},t.data.params,a),R.a.get(t.baseUrl+"api/presence/v1/connected/daily",t.data).then(function(t){e.setState({connected:t.data})}).catch(function(e){console.log(e)})}},{key:"fetchPasserby",value:function(){var e=this,t=M(),a={};a.startDate=this.state.startDate,a.endDate=this.state.endDate,t.data.params=Object(x.a)({},t.data.params,a),R.a.get(t.baseUrl+"api/presence/v1/passerby/daily",t.data).then(function(t){e.setState({passerby:t.data})}).catch(function(e){console.log(e)})}},{key:"fetchVisitors",value:function(){var e=this,t=M(),a={};a.startDate=this.state.startDate,a.endDate=this.state.endDate,t.data.params=Object(x.a)({},t.data.params,a),R.a.get(t.baseUrl+"api/presence/v1/visitor/daily",t.data).then(function(t){e.setState({visitors:t.data})}).catch(function(e){console.log(e)})}},{key:"isKeyPresentInObj",value:function(e,t){return"undefined"!==typeof this.state[t][e]}},{key:"predict",value:function(e){if("undefined"!==typeof this.state[e]){for(var t=b()(this.state.endDate).add(-6,"days").format("Y-MM-DD"),a=0,n=[];this.isKeyPresentInObj(t,e);)n.push(this.state[e][t]),t=b()(t).add(-7,"days").format("Y-MM-DD"),a++;return console.log("counts: ",n),console.log("i: ",a),parseInt(this.countAverage(n,a))}return 0}},{key:"countAverage",value:function(e,t){var a=0;return e.map(function(e,t){a+=e}),a/t}},{key:"render",value:function(){var e=this,t={};return Re.map(function(a,n){t[a]=e.predict(a)}),r.a.createElement(f.a,{item:!0,xs:12,sm:6,md:3,className:"m-t-sm-24"},r.a.createElement(L.a,{style:{height:"100%"}},r.a.createElement(A.a,null,r.a.createElement("div",{className:"textRow"},r.a.createElement(W.b,{gutterBottom:!0,variant:"headline"},"Tomorrow"),r.a.createElement(Ne.a,{style:{fontSize:32}})),r.a.createElement("hr",null),r.a.createElement("div",{className:"textRow"},r.a.createElement(W.b,{className:"rowTitle",gutterBottom:!0,variant:"caption"},"Visitors:"),r.a.createElement(W.b,null,"~",t.visitors)),r.a.createElement("div",{className:"textRow"},r.a.createElement(W.b,{className:"rowTitle",gutterBottom:!0,variant:"caption"},"Connected:"),r.a.createElement(W.b,null,"~",t.connected)),r.a.createElement("div",{className:"textRow"},r.a.createElement(W.b,{className:"rowTitle",gutterBottom:!0,variant:"caption"},"Passerby:"),r.a.createElement(W.b,null,"~",t.passerby)))))}}]),t}(n.Component),Pe=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).buildQueryDateParams=function(){return a.state.startDate===a.state.endDate?{date:a.state.startDate}:{startDate:a.state.startDate,endDate:a.state.endDate}},a.fetchSummary=function(){var e=M();e.data.params=Object(x.a)({},e.data.params,a.buildQueryDateParams()),R.a.get(e.baseUrl+"api/presence/v1/kpisummary",e.data).then(function(e){console.log("result.data",e.data),a.setState({summary:e.data})}).catch(function(e){console.log(e)})},a.state={startDate:a.props.startDate,endDate:a.props.endDate,summary:void 0},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this;this.setState({startDate:e.startDate,endDate:e.endDate},function(){a.fetchSummary()})}},{key:"render",value:function(){return"undefined"===typeof this.state.summary?r.a.createElement("div",null):r.a.createElement(f.a,{container:!0,direction:"row",spacing:24,className:"sm-no-spacing"},r.a.createElement(je,{connected:this.state.summary.totalConnectedCount,passerby:this.state.summary.totalPasserbyCount,visitors:this.state.summary.totalVisitorCount,precentage:this.state.summary.connectedPercentage,conversionRate:this.state.summary.conversionRate}),r.a.createElement(Ce,{averageDwellTime:this.state.summary.averageDwell,peakSummary:this.state.summary.peakSummary?this.state.summary.peakSummary:this.state.summary.peakWeekSummary,dwellLevels:this.state.summary.averageDwellByLevels}),r.a.createElement(ke,{devices:this.state.summary.topManufacturers.manufacturerCounts}),r.a.createElement(_e,null))}}]),t}(n.Component),Ue=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).getQueryParams=function(e){a.setState({startDate:e.startDate,endDate:e.endDate})},a.state={startDate:b()(new Date).format("Y-MM-DD"),endDate:b()(new Date).format("Y-MM-DD")},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"wrapper-md-24"},r.a.createElement(f.a,{container:!0,direction:"column"},r.a.createElement(f.a,{item:!0,xs:12,className:"wrapper-24"},r.a.createElement(k,{handleParams:this.getQueryParams})),r.a.createElement(Pe,{startDate:this.state.startDate,endDate:this.state.endDate}),r.a.createElement(te,{startDate:this.state.startDate,endDate:this.state.endDate}),r.a.createElement(ue,{startDate:this.state.startDate,endDate:this.state.endDate}),r.a.createElement(Oe,{startDate:this.state.startDate,endDate:this.state.endDate})))}}]),t}(n.Component),Me=a(189),Ye=a.n(Me),He=a(190),Ae=a.n(He),Fe=a(130),Le=a.n(Fe),Be=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e,t){a.setState({value:t})},a.state={value:0},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"logout",value:function(){localStorage.removeItem("cisco_auth"),window.location.reload()}},{key:"render",value:function(){return"/login"===this.props.location.pathname?r.a.createElement("div",null):r.a.createElement(Ye.a,{position:"static"},r.a.createElement(Ae.a,{value:this.state.value,onChange:this.handleChange,centered:!0},r.a.createElement(Le.a,{label:"Analytics",component:d.b,to:"/"}),r.a.createElement(Le.a,{label:"Location",component:d.b,to:"/location"}),r.a.createElement(Le.a,{label:"Log Out",onClick:this.logout.bind(this)})))}}]),t}(n.Component),Ve=a(52),We=a.n(Ve),Ke=a(80),Ge=a(150),Qe=a.n(Ge),ze=a(191),qe=a.n(ze),Xe=a(71),Je=a.n(Xe),$e=a(79),Ze=a.n($e),et=a(70),tt=a.n(et),at=a(127),nt=a.n(at),rt=(a(900),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).state={presenceUname:"",presencePass:"",locationUname:"",locationPass:"",error:!1},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"handleChange",value:function(e){"presenceUname"===e.target.name?this.setState({presenceUname:e.target.value}):"presencePass"===e.target.name?this.setState({presencePass:e.target.value}):"locationUname"===e.target.name?this.setState({locationUname:e.target.value}):"locationPass"===e.target.name&&this.setState({locationPass:e.target.value})}},{key:"handleSubmit",value:function(){var e=Object(Ke.a)(We.a.mark(function e(){var t,a;return We.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==this.state.presencePass&&""!==this.state.presenceUname&&""!==this.state.locationPass&&""!==this.state.locationUname){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,t="Base "+btoa(this.state.presenceUname+":"+this.state.presencePass),e.next=6,R.a.get(P.a.presence+"api/config/v1/sites",{headers:{Authorization:t}});case 6:a=e.sent,localStorage.setItem("siteId",JSON.stringify({id:a.data[0].aesUId})),localStorage.setItem("cisco_auth",JSON.stringify({presence:"Base "+btoa(this.state.presenceUname+":"+this.state.presencePass),location:"Base "+btoa(this.state.locationUname+":"+this.state.locationPass)})),window.location.reload(),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),401==e.t0.response.status&&(localStorage.removeItem("cisco_auth"),this.props.history.push("/login"),this.setState({error:!0})),R.a.post("/error",{data:e.t0.message}).catch(function(e){console.log(e)});case 16:case"end":return e.stop()}},e,this,[[2,12]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return localStorage.getItem("cisco_auth")?r.a.createElement(h.a,{to:"/"}):r.a.createElement("div",{className:"LoginWrapper"},r.a.createElement("div",{className:"Main"},r.a.createElement(qe.a,null),r.a.createElement(tt.a,{className:"Paper"},r.a.createElement(V.a,{component:"h1",variant:"h5"},"Credentials"),r.a.createElement("form",{className:"form",onSubmit:this.handleSubmit.bind(this)},r.a.createElement("div",{className:"InerBox"},r.a.createElement(nt.a,{component:"legend"},"Cisco_CMX_Locate"),r.a.createElement(j.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(Ze.a,{htmlFor:"text"},"Username"),r.a.createElement(Je.a,{error:this.state.error,required:!0,name:"locationUname",autoComplete:"text",autoFocus:!0,onChange:this.handleChange.bind(this)})),r.a.createElement(j.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(Ze.a,{htmlFor:"password"},"Password"),r.a.createElement(Je.a,{error:this.state.error,required:!0,name:"locationPass",type:"password",autoComplete:"current-password",onChange:this.handleChange.bind(this)}))),r.a.createElement("div",{className:"InerBox"},r.a.createElement(nt.a,{component:"legend"},"Cisco_CMX_Presence"),r.a.createElement(j.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(Ze.a,{htmlFor:"text"},"Username"),r.a.createElement(Je.a,{error:this.state.error,required:!0,name:"presenceUname",autoComplete:"text",autoFocus:!0,onChange:this.handleChange.bind(this)})),r.a.createElement(j.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(Ze.a,{htmlFor:"password"},"Password"),r.a.createElement(Je.a,{error:this.state.error,required:!0,name:"presencePass",type:"password",autoComplete:"current-password",onChange:this.handleChange.bind(this)}))),r.a.createElement(Qe.a,{fullWidth:!0,variant:"contained",color:"primary",className:"Submit",onClick:this.handleSubmit.bind(this)},"Submit")))))}}]),t}(n.Component)),st=a(56),ot=a(100),ct=a(151),it=a.n(ct),lt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(){return function(e){a.setState({value:e.target.value}),a.props.handleChange(a.props.title,e.target.value)}},a.state={list:a.props.name,value:""},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.value?this.setState({value:e.value}):this.setState({list:e.name.sort()})}},{key:"render",value:function(){var e=this.props.classes;return r.a.createElement("form",{className:e.container,noValidate:!0,autoComplete:"off"},r.a.createElement(w.a,{id:"outlined-select-currency",select:!0,label:"Select",className:e.textField,value:this.state.value,onChange:this.handleChange(),helperText:"Please select your "+this.props.title,margin:"normal",variant:"outlined"},this.state.list.map(function(e,t){return r.a.createElement(it.a,{key:t,value:e},e)})))}}]),t}(r.a.Component),mt=Object(E.withStyles)(function(e){return{container:{display:"flex",flexWrap:"wrap"},textField:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit},dense:{marginTop:16},menu:{width:200}}})(lt),ut=a(405),ht=a(193),dt=a.n(ht),pt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e,t){a.setState(Object(ot.a)({},e,t))},a.setFloor=function(e){a.state.floorList.map(function(t){a.state[t]===e&&a.setState({floor:t})})},a.handleClick=function(e){a.setState({open:!0,msg:e})},a.handleClose=function(){a.setState({open:!1})},a.state={floorList:[],campusName:[],buildName:[],floorValue:"",open:!1,vertical:"bottom",horizontal:"left",msg:"test"},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=Object(Ke.a)(We.a.mark(function e(){var t,a,n,r;return We.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=P.a.location+"api/config/v1/maps",a=JSON.parse(localStorage.getItem("cisco_auth")).location,e.next=5,R.a.get(t,{headers:{Authorization:a}});case 5:n=e.sent,r=this,n.data.campuses.map(function(e){r.setState(function(t){return{campusName:[].concat(Object(st.a)(t.campusName),[e.name])}}),e.buildingList.map(function(e){r.setState(function(t){return{buildName:[].concat(Object(st.a)(t.buildName),[e.name])}}),e.floorList.map(function(e){r.setState(function(t){return Object(ot.a)({floorList:[].concat(Object(st.a)(t.floorList),[e.name])},e.name,e.aesUidString)})})})}),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0),R.a.post("/error",{data:e.t0.message}).catch(function(e){console.log(e)});case 14:case"end":return e.stop()}},e,this,[[0,10]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.vertical,a=e.horizontal,n=e.open,s=e.msg;return r.a.createElement("div",null,r.a.createElement(f.a,{container:!0,direction:"row",justify:"flex-start",alignItems:"flex-start"},r.a.createElement(mt,{name:this.state.campusName,title:"campus",handleChange:this.handleChange}),r.a.createElement(mt,{name:this.state.buildName,title:"bulding",handleChange:this.handleChange}),r.a.createElement(mt,{name:this.state.floorList,title:"floor",handleChange:this.handleChange,value:this.state.floor})),r.a.createElement(f.a,{container:!0,direction:"row",justify:"center",alignItems:"flex-start"},r.a.createElement(ut.a,{imageSrc:"/"+this.state.campus+"/"+this.state.bulding+"/"+this.state.floor,floor:this.state[this.state.floor],campus:this.state.campus,build:this.state.bulding,setFloor:this.setFloor,notification:this.handleClick}),r.a.createElement(dt.a,{anchorOrigin:{vertical:t,horizontal:a},open:n,onClose:this.handleClose,ContentProps:{"aria-describedby":"message-id"},autoHideDuration:3e3,message:r.a.createElement("span",{id:"message-id"},s)})))}}]),t}(n.Component),ft=function(e){return localStorage.getItem("cisco_auth")?function(){return r.a.createElement(e,null)}:function(){return r.a.createElement(h.a,{to:"/login"})}},vt=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(d.a,null,r.a.createElement(h.b,{path:"/",component:Be}),r.a.createElement(h.b,{exact:!0,path:"/",component:ft(Ue)}),r.a.createElement(h.b,{path:"/location",component:ft(pt)}),r.a.createElement(h.b,{path:"/login",component:rt}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(960);o.a.render(r.a.createElement(vt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[492,1,2]]]);
//# sourceMappingURL=main.6656c80b.chunk.js.map